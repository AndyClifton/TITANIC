function SubWriteSonicDataMATLAB(sonic_data,...
	output_path,output_file)

%% empty variables, labels, data and attributes
VAL = {};
VNAME ={};
VLABEL= {};
UNITS = {};
HEIGHT = {};

%% individual channel statistics

% define labels
labels = {'dt_clean';...
	'x_clean';...
	'y_clean';...
	'z_clean';...
	'Temp_clean';
	'dt_rotated';...
	'u';...
	'v';...
	'w';...
	'Temp_rotated'};
% define fields
fields = {'clean';...
	'clean';...
	'clean';...
	'clean';...
	'clean';...
	'rot';...
	'rot';...
	'rot';...
	'rot';...
	'rot'};
subfields = {'dt';...
	'x';...
	'y';...
	'z';...
	'T';...
	'dt';...
	'u';...
	'v';...
	'w';...
	'T'};

% units
units = {'s';...
	'm/s';...
	'm/s';...
	'm/s';...
	'K';...
	's';...
	'm/s';...
	'm/s';...
	'm/s';...
	'K'};

for si = 1:numel(sonic_data)
	if ~isempty(sonic_data{si})
		% get the sonic height
		z = sonic_data{si}.height;
		% work through the labels that we know exist for this sonic
		for fi = 1:numel(labels)
			% get the variable name
			vname = ['Sonic_' labels{fi}];
			% get the data
			VAL{end+1} = reshape(sonic_data{si}.(fields{fi}).(subfields{fi}),[],1);
			% get the final name that we will use in the output
			% file
			VNAME{end+1} = [vname '_' num2str(z) 'm'];
			% create a label for figures
			VLABEL{end+1} = [strrep(vname,'_',' ') ' (' num2str(z) ' m)'];
			% define units
			UNITS{end+1} = units{fi};
			% and the height
			HEIGHT{end+1} = z;
		end
	end
end

%% export the data
for vi = 1:numel(VNAME)
	% make a new variable
	data_out.(VNAME{vi}).val = VAL{vi};
	data_out.(VNAME{vi}).label = VLABEL{vi};
	data_out.(VNAME{vi}).units = UNITS{vi};
	data_out.(VNAME{vi}).height = HEIGHT{vi};
end

%% and write it out
save(fullfile(output_path,output_file),'-struct','data_out','-append')